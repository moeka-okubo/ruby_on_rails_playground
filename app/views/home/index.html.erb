<% content_for :title, "TODOリストのページ" %>
<div class="container">
  <h1 class="title">TODOリスト</h1>
  <p class="title-note">Railsの勉強用</p>
</div>
<div class="features">
  <h2>TODOリスト</h2>
  <table class="tasks">
    <thead>
      <tr>
        <th>ID</th>
        <th></th>
        <th>タイトル</th>
        <th>内容</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <% @tasks.each do |task| %>
        <tr>
          <td><%= task.id %></td>
          <td class="task-complete">
            <%= form_with(model: task, url: task_path(task), method: :patch, local: true) do |form| %>
              <%= render(ToggleComponent.new(form: form,id: task.id, is_active: task.completed, on_change: "this.form.requestSubmit()" )) %>
            <% end %>
          </td>
          <td><%= task.title %></td>
          <td><%= task.description %></td>
          <%= form_with(model: task, url: task_path(task), method: :delete) do |form| %>
            <td class="task-delete">
              <%= render(ButtonComponent.new(label: "削除", type: "submit", is_danger: true)) %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
  <h2>新しいTODOを追加</h2>
  <%= form_with(model: @task, url:tasks_path) do|form| %>
    <table class="new-task">
      <tr class="new-form-row">
        <th class="new-form-header">タイトル</th>
        <td class="new-form-cell"><%= form.text_field :title, class: "new-form" %></td>
      </tr>
      <tr class="new-form-row">
        <th class="new-form-header">内容</th>
        <td class="new-form-cell"><%= form.text_area :description, class: "new-form description" %></td>
      </tr>
    </table>
    <%= render(ButtonComponent.new(label: "追加", type: "submit")) %>
  <% end%>
</div>
